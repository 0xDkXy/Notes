### Project Objectives / Purpose of proposed investigation
#### origin

The proposed investigation delves into the sphere of computer security, with a specific focus on bolstering the safeguarding of mobile systems, particularly within OpenHarmony OS.  

In the past 10 years, with technological enhancements and spreading, the number of mobile devices has increase greatly. Mobile devices, like IoT devices and smartphone, have entered the people daily life already, both for the personal and professional aspects of their lives. Statista forecast that, by 2023, there will be 4.3 billion smartphone users. OpenHarmony is an open-source version of HarmonyOS donated by Huawei to the OpenAtom Foundation. It is an operating system that designed for the smartphone, and also for the Internet of Things, wireless routers, tablet computers and other smart terminal devices. After nearly 4 years developing, OpenHarmony now releases the 4th version. It becomes wider and wider usage. However, the security issues are always huge problems that all the developers and users should take care of.

The cost competitiveness in the smartphone market has also contributed to the growth of the number of the devices and has made smartphone available to the middle- and lower-income groups as well. This availability and the features of the latest smartphone have make the population dependent on these phones for their daily work, such as paying house-hold through phone banking or transferring essential documents.

The operating system is an integral part of these smartphones and is responsible for the functioning of the device, which makes it prone to attacks that take control of the device. Hence, it becomes essential for the developers and researchers to enhance the ability of protecting from attacks and the ways to find out the potent vulnerability.

Malware families that are popular are spyware, bots, Adware, Potentially Unwanted Applications, Trojans, and Trojan spyware. PUA is the topmost Android malware detect by Quick Heal. In 2016, Kaspersky Lab detected 128886 lakh mobile banking Trojans and abround 261214 mobile Ransomware Trojans. Gugi is an example of a banking Trojan that can exploit the security policeis of Android Marshmalow. The majority of malicious applications are designed to gain root access to the system, and the malware developers craft them so well that it is tough to detect them, and they keep on working in silence; users have no idea that the malware has endangered their system. After gaining control of these systems, these malicious applications can perform dangerous actions and can also infect other devices connected to the infected system. The developers of malicious applications are earning a considerable amount of money from this source. The Dark Web is one such example; it is a marketplace for criminals to buy and sell mobile malware, and the malware developers sell it as a component of software packages. On the Dark Web, malware and some other tools that are capable of evading many operating system like Android and iOS are available at a lower price, thereby gaining the interest of hackers and causing an increase in criminal activities. Malware has become a severe threat to modern society, which is increasingly becoming dependent on smart technologies for day-to-day activities. And the similar malware can also invade the OpenHarmony OS. Then make huge hurt to the users and the system. So it is necessary to find the way to protect users and operating system from attacks.

These vulnerabilities hiding in the system are the key or gate that usually make use of. The exploitation of permission, lack of awareness regarding security protocols, poor developer practices and coding skill, these are all possible factors that make vulnerability. So it is important to find the ways and methods to detect the vulnerability existing in the system efficiently. Reducing potential vulnerability and enhance the security mechanism could increase the difficulty that developers of malware to attack and steal users' privacy. That could protect the system and its' users efficiently.
#### Revised 0
The central focus of this proposed investigation is to delve into the realm of computer security, with a specific emphasis on bolstering the protection of mobile systems, particularly within the ambit of OpenHarmony OS.

Over the past decade, due to technological advancements and pervasive integration, the number of mobile devices has experienced an unprecedented surge. Mobile devices, including IoT devices and smartphones, have seamlessly woven themselves into people's daily lives, influencing both their personal and professional spheres. According to Statista's projections, the number of smartphone users is expected to reach a staggering 4.3 billion by 2023. OpenHarmony represents an open-source iteration of HarmonyOS, graciously donated by Huawei to the OpenAtom Foundation. Designed not only for smartphones but also for the Internet of Things, wireless routers, tablet computers, and other smart terminal devices, OpenHarmony has evolved through almost four years of development, culminating in its fourth version. Its usage is expanding at an exponential pace. Nonetheless, the persistent specter of security vulnerabilities remains a substantial challenge, demanding the vigilant attention of developers and users alike.

This research endeavor also recognizes the role of cost competitiveness in fostering the proliferation of smartphones, extending their accessibility to middle- and lower-income groups. These devices, characterized by their advanced features, have engendered a reliance on smartphones for essential daily tasks, such as mobile banking transactions and secure document transfers.

At the heart of this technological landscape lies the operating system, a foundational element responsible for the device's seamless operation. However, its critical role renders it susceptible to attacks that seek to compromise its integrity. Therefore, it becomes imperative for developers and researchers to fortify its defenses against potential breaches and vulnerabilities.

The contemporary threat landscape includes various categories of malware, such as spyware, bots, adware, Trojans, and Trojan spyware. One notorious example is the Gugi banking Trojan, which exploits Android Marshmallow's security policies. The surge in mobile malware is evident, with instances like Kaspersky Lab detecting over 128,886 lakh mobile banking Trojans and approximately 261,214 mobile Ransomware Trojans in 2016 alone. The majority of these malicious applications aim to gain root access to the system and operate stealthily, evading detection and wreaking havoc unbeknownst to users. Such threats not only compromise the infected system but can also propagate to other interconnected devices. Malicious software developers exploit this scenario, profiting from their activities through avenues like the Dark Webâ€”a marketplace for trading mobile malware as components of software packages.

These menaces have now permeated modern society, where reliance on smart technologies for everyday activities is ubiquitous. The proposed research acknowledges the potential intrusion of such malware into the OpenHarmony OS, which could have severe implications for users and the system. Therefore, the research's overarching goal is to develop strategies to protect both users and the operating system from these pernicious attacks.

The vulnerabilities embedded within systems often serve as the gateways exploited by attackers. Factors such as permissions exploitation, lack of awareness about security protocols, poor developer practices, and coding deficiencies can all contribute to vulnerability. Consequently, the research strives to identify efficient methods for detecting these vulnerabilities and mitigating their impact. By reducing potential vulnerabilities and enhancing security mechanisms, the research aims to increase the complexity of attacks, making it more challenging for malware developers to compromise user privacy and system integrity.

In summary, this research seeks to address the critical intersection of computer security and software engineering, concentrating on the imperative task of safeguarding mobile systems within the OpenHarmony OS framework. The ultimate aspiration is to contribute to a safer technological landscape, where the integrity and privacy of users remain uncompromised in the face of emerging threats.

#### Revised 0 Another Version
The crux of this research endeavor lies in the intricate domain of computer security, where the paramount objective is to fortify the protective bastions of mobile systems, with an unswerving gaze directed towards the realm of OpenHarmony OS. This proposal serves as an intellectual beacon, guiding the exploration into a critical intersection of computer security and software engineering, where the overarching goal is to advance the frontiers of safeguarding in the dynamic landscape of mobile technology.

The epoch of the past decade stands as a testament to the exponential proliferation of technological marvels, particularly in the form of mobile devices. These instruments of technological convergence, ranging from the multifaceted nodes of the Internet of Things to the ubiquitous smartphones, have seamlessly intertwined themselves into the tapestry of contemporary human existence. In both personal and professional domains, these devices have emerged as indispensable companions, rendering life's multifarious tasks and challenges with unprecedented efficiency. Forecasts from Statista, a herald of trends, portend an awe-inspiring congregation of 4.3 billion smartphone acolytes by the eve of 2023.

At the heart of this study stands OpenHarmony, an embodiment of innovation that stems from the gracious donation of HarmonyOS by Huawei to the OpenAtom Foundation. Akin to a symphony conductor, OpenHarmony orchestrates the harmony of technological ecosystems across smartphones, Internet of Things paradigms, wireless routers, tablet computers, and an array of smart terminal envoys. Through nearly four years of meticulous refinement, OpenHarmony has metamorphosed into its fourth iteration, solidifying its eminence as an indispensable companion to contemporary life. However, a proverbial shadow looms large - the specter of security vulnerabilities. In the wake of its pervasive adoption, the pivotal task of safeguarding against potential breaches becomes not only a challenge but a sacred responsibility that resonates with developers and users alike.

Yet, this surge in mobile device prevalence is not solely attributed to technological allure; rather, the economic vibrancy of the smartphone market has democratized access to these marvels, bridging economic strata and rendering smartphones integral to the lives of middle- and lower-income groups. These devices transcend mere communication tools, wielding the power to facilitate banking transactions, secure document transfers, and an array of daily tasks that have become interwoven with the fabric of contemporary living.

Central to this technological tapestry is the operating system - the architectural cornerstone that steers the device's functionality. However, its centrality also renders it vulnerable to a myriad of potential attacks that could wrest control from its rightful owner. This vulnerability necessitates a concerted effort to amplify its defenses, enabling it to thwart and repel potential breaches. As the malware landscape evolves, diverse categories like spyware, bots, adware, and Trojans have etched their mark, redefining the parameters of threat. Instances abound, such as the Gugi banking Trojan exploiting Android Marshmallow's security policies, or the nefarious exploits enabled by the Dark Web's illicit marketplace for mobile malware.

This symphony of threats underscores the urgency to uncover and address vulnerabilities that lie dormant within systems. Permissions exploitation, security protocol unawareness, suboptimal development practices, and coding vulnerabilities are all intricate threads that weave the tapestry of system vulnerability. This research commitment seeks to illuminate these threads, unraveling their nuances and intricacies to develop robust methods of detection. Through this endeavor, the aspiration is to not only ameliorate vulnerabilities but also to enhance the security infrastructure, raising the impenetrable ramparts against malicious intent.

In the grand tapestry of technology, security vulnerabilities are the subtle gates that malevolent forces seek to exploit. By illuminating these gateways and developing methods to fortify them, this research aspires to create a robust shield against potential attacks. The ultimate goal is a safer technological ecosystem, one where developers of malevolent software face formidable challenges, and users can harness the full potential of technology without compromising their privacy and security. Thus, the resonance of this research extends beyond the confines of academia, resonating in the very fabric of modern society, where technology is an irreplaceable companion in daily life.

## Scope and Backgroud of Research
Please identify key issue/problems to be addressed

OpenHarmony, also known as OHOS, stand as an open-source iteration of HarmonyOS. This innovative platform marks a new era in mobile operating systems. intended for deployment on smart devices such as smartphones and various embedded terminals. So the security issue of it is more than important. The key issue of this research is focus on how to enhance the security of Openharmony and its related applications.

In order to improve the security of OpenHarmony system and protect the system and its users, the first steps is to know and get familiar with the factors that threaten its security. In other words, we need to be familiar with the methods how to attack OpenHarmony OS. The categories of those attacks can be classified into four different categories based on the components of its targets. They are a). Hardware-based attacks, b). Kernel-based attacks, c). Hardware abstraction layer-based attacks and d). Applications-based attacks.

To attack the hardware, attacks target the vulnerabilites found in the hardware components. Most of the vulnerabilities exist because of the preinstalled vulnerable components provided by the manufactures. It is tough to protect the system from attacks that target such components. These vulnerabilities are very difficult to patch, because the patches are available with the distributors and carriers only.

A kernel is the heart of the mobile system. There is not the only choice of kernel to OpenHarmony, besides Linux Kernel, OpenHarmony also can use LiteOS as its kernel. Attacks targeting kernel are aimed at getting root access to the system and can cause severe damage. The kernel is directly or indirectly responsible for every action performed on the system and also for the management of different components. And it also takes care of the runtime environment (on OHOS, it's ark runtime) functionalities. Attackers are continually working in the direction of exploiting vulnerabilities in the kernel and related components like device drivers, memory, and JS VM(JavaScript Virtual Machine, counterpart as Android Runtime). Some kernel-based attacks target root privilege. These attacks target the vulnerabilities found in the kernel to exploit privileges. Another attacks that targeting memory. In these attacks, attackers exploits memory corruption vulnerability to alter the memory without giving instructions explicitly and then execute the malicious code that write into memory. There are also kernel-based attacks that target bootloader and device driver

The application-based attacks exploit the vulnerability of default applications as well as the applications installed into the system. Attackers take advantage of the exploited permissions and use attacks like privilege escalation, for exploiting the target system , at different level. Attackers are also misusing the flaws in native libraries and the third-party libraries found in the applications. They use these libraries to request for combined permissions. Escalated privilege rights give attackers access to any component of the victimâ€™s system, including the kernel. Attackers can even gain root privileges and can cause irreparable damage to the system. After sneaking into the system, attackers can spy on the userâ€™s data for personal motive or can sell it to third parties for money.

So, in order to reduce the exploitation of vulnerability, it is necessary for the researchers and developers to find out the new methods of detecting the potential vulnerability existing in the system or enhance the existed methods to cover more situations and speed them up, making them more efficient. The way to detect vulnerability can divide into two categories, the static method and the dynamic method. Static analysis can analyse both source code files and configuration files like JSON and XML without executing them. In contrast to that, dynamic analysis is used to analyse the application by executing it in a sandbox runtime environment.

The OpenHarmony OS is not the same as other mobile system like Android. So we need to design new method or revise the existed detection method to adapt it.

### revised 0
OpenHarmony, also referred to as OHOS, stands as a pioneering manifestation of HarmonyOS, signifying a revolutionary epoch in mobile operating systems. Engineered to thrive within a plethora of smart devices, ranging from smartphones to embedded terminals, the resounding significance of securing OpenHarmony cannot be overstated. This research embarks on a journey to fortify the bastions of OpenHarmony's security landscape and safeguard the integrity of both the system and its users, accentuating the critical importance of this endeavor.

To advance the security of the OpenHarmony ecosystem, the initial step entails an exhaustive understanding of the diverse factors that pose threats to its sanctity. In essence, it demands an intimate familiarity with the methodologies employed to breach the defenses of OpenHarmony OS. These attacks crystallize into four distinctive categories, each targeting different facets of its architecture:

a) **Hardware-based attacks:** In this realm, vulnerabilities within hardware components become the focal point. A substantial portion of these vulnerabilities stems from preinstalled components furnished by manufacturers, rendering fortification against such attacks arduous. Due to the intricacies of these vulnerabilities and the decentralized nature of patches, mitigation becomes a formidable challenge.

b) **Kernel-based attacks:** The kernel stands as the nucleus of a mobile system, holding paramount influence over its functions. OpenHarmony is graced with a dual kernel landscape, offering both Linux Kernel and LiteOS as choices. This critical position renders kernel-based attacks as particularly pernicious. These attacks endeavor to seize root access to the system, potentially inflicting severe damage. As the arbiter of every operation and the orchestrator of system components, a compromised kernel cascades into dire consequences. Memory manipulation, device driver exploits, and root privilege assaults are recurrent themes within this realm.

c) **Hardware abstraction layer-based attacks:** Attacks directed at the hardware abstraction layer (HAL) exploit vulnerabilities within this intermediary stratum. Given the pivotal role HAL plays in mediating interactions between hardware and software, its vulnerabilities expose a precarious entry point for attackers. The exploitation of these vulnerabilities can lead to a cascade of far-reaching consequences, transcending the boundaries of mere component compromise.

d) **Applications-based attacks:** This category encompasses a diverse array of attacks that capitalize on vulnerabilities within both default and user-installed applications. Attackers leverage these vulnerabilities to breach security barriers, often executing privilege escalation tactics to exploit the system at varying levels. Native and third-party libraries become conduits for exploitation, enabling attackers to manipulate permissions, infiltrate the kernel, and seize root privileges. Once within the system's inner sanctum, attackers can extract sensitive data for personal gain or vend it to third parties.

To counteract the exploitation of vulnerabilities, researchers and developers must innovate in the realm of detection methodologies. Novel approaches or enhancements to existing techniques are imperative to accommodate OpenHarmony's unique architecture. This bifurcates into two categories:

a) **Static analysis:** A comprehensive scrutiny of both source code files and configuration files like JSON and XML is conducted without code execution. This method reveals latent vulnerabilities that could be exploited when the application is executed.

b) **Dynamic analysis:** This approach involves executing the application within a controlled sandboxed environment, facilitating real-time analysis of its behavior. By immersing the application in a runtime environment, dynamic analysis scrutinizes its actions, unveiling potential vulnerabilities that might evade static analysis.

OpenHarmony OS distinguishes itself from its counterparts, necessitating novel methodologies or tailored adaptations of existing methods. The holistic goal is to usher in a new era of security mechanisms meticulously calibrated to this unique ecosystem. This research manifests as a bridge between the paradigms of computer security and software engineering, safeguarding OpenHarmony against an evolving landscape of threats while advancing the collective knowledge base in securing modern computing ecosystems.
## Research Methodology

The research methodology for this study encompasses a range of strategic approaches, each meticulously tailored to extract insights and enhance the security of OpenHarmony OS. The following methods delineate the roadmap for investigation:

Static Analysis:

Static analysis is a kind of method that can analysis the source code file and configuration file like JSON file and XML file without executing them. 

OpenHarmony applications, crafted using JavaScript and the superset ArkTS, often contain pivotal JSON files like app.json5 and module.json5, housing vital configuration information. Static analysis facilitates the comprehensive examination of these files without execution. 

The analysis of configuration files extracts critical details like package names and permissions, fortifying the understanding of application characteristics. 

This method also extends to code analysis, focusing on the source code itself. Code analysis delves into elements such as API calls, information flow, taint tracking, native code interactions, clear-text analysis, and opcodes, thereby unveiling intricate nuances in application behavior.

Formal methods is a kind of static analysis method. Formal methods is the term applied to the analysis of software (and computer hardware) whose results are obtained purely through the use of rigorous mathematical methods. The mathematical techniques used include denotational semantics, axiomatic semantics, operational semantics, and abstract interpretation.

Some of the implementation techniques of formal static analysis include:
 - Abstract interpretation, to model the effect that every statement has on the state of an abstract machine (i.e., it 'executes' the software based on the mathematical properties of each statement and declaration). This abstract machine over-approximates the behaviours of the system: the abstract system is thus made simpler to analyze, at the expense of _incompleteness_ (not every property true of the original system is true of the abstract system). If properly done, though, abstract interpretation is _sound_ (every property true of the abstract system can be mapped to a true property of the original system).
 - Data-flow analysis, a lattice-based technique for gathering information about the possible set of values;
 - Hoare logic, a formal system with a set of logical rules for reasoning rigorously about the correctness of computer programs.
 - Model checking, considers systems that have finite state or may be reduced to finite state by abstraction;
 - Symbolic execution, as used to derive mathematical expressions representing the value of mutated variables at particular points in the code.

Dynamic Analysis:

Dynamic analysis harnesses the power of execution within a controlled sandbox runtime environment. This approach mandates a fully realized product, an OpenHarmony application complete with multiple HAP packages. By executing the application within this controlled setting, vulnerabilities and potential malware instances can be effectively identified. The potency of dynamic analysis lies in its capacity to scrutinize real-time behaviors during application runtime.

Network traffic analysis, code instrumentation, system call analysis, system resource analysis, and user interaction analysis, they were five feature extraction techniques identified for the dynamic analysis. Network-related features, process-related features, usage-related details, and component interactions were extracted using those five methods. Under the network-related features, uniform resource locators, internet protocols, network protocols, network certificates, and network traffic were considered while considering non-encrypted data, Java classes, intents, and system call for process-related features. Usage-related features such as processor, memory, battery, network, and process reports were also considered. Additionally, buttons, icons, actions, and events were considered for user interaction analysis features.


Hybrid Analysis:

Hybrid analysis ingeniously combines the strengths of both static and dynamic paradigms. It begins with decompilation to leverage static attributes such as permissions and intents. Subsequently, the application is executed within an emulator to discern intricate behaviors, culminating in a holistic understanding of application dynamics.

For example, the study in reference(Feature engineering based on hybrid features for malware detection over Android framework) used static features, including permissions and intents and dynamic features, including IPs, emails, and URLs, to extract various information related to applications.

Machine Learning Methods:

Incorporating the prowess of machine learning (ML) and deep learning (DL), this research employs a diverse range of algorithms, including Naive Bayes (NB), Logistic Regression (LR), Decision Trees (DT), Random Forests (RF), Gradient Boosting (GB), Long Short-Term Memory networks (LSTM), Recurrent Neural Networks (RNN), and Multi-Layer Perceptrons (MLP). These techniques take center stage in vulnerability detection, where the generalization of source code into a structured format lays the foundation. By training neural network models on extensive datasets, the study endeavors to pinpoint vulnerabilities embedded within the source code and the nefarious behaviors exhibited by malicious applications.

The fusion of these methodologies represents a cohesive and multifaceted approach to comprehensively address the challenges posed by OpenHarmony OS security concerns. By delving deep into static, dynamic, hybrid, and machine learning realms, this research strives to create a robust and comprehensive framework for enhancing system security.